{"version":3,"sources":["assets/images/logo.png","component/common/SharedCompt.jsx","view/info/News.jsx"],"names":["module","exports","__webpack_require__","p","UserLogin","_React$Component","props","_this","Object","_Applications_MAMP_htdocs_project_react_cnode_project_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","_Applications_MAMP_htdocs_project_react_cnode_project_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","_Applications_MAMP_htdocs_project_react_cnode_project_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","state","btnval","loginSubmit","bind","_Applications_MAMP_htdocs_project_react_cnode_project_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__","_Applications_MAMP_htdocs_project_react_cnode_project_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__","_Applications_MAMP_htdocs_project_react_cnode_project_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","key","value","e","is","keyCode","_this2","UserTokenVal","refs","userToken","$showMsg","setState","$request","method","url","data","accesstoken","success","result","setStorage","history","push","pathname","search","concat","loginname","error","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","className","ref","type","name","onKeyDown","enterSumit","placeholder","onClick","React","Component","NotLogin","isLogo","src","require","alt","data-layout-align","data-layout","react_router_dom__WEBPACK_IMPORTED_MODULE_7__","to","defaultProps","DetectLogin","_React$Component2","LoginStatus","apply","arguments","$getStorage","realuser","LoadLoop","LoadFail","NotResult","text","TabPane","antd_es_tabs__WEBPACK_IMPORTED_MODULE_7__","UserNews","_Applications_MAMP_htdocs_project_react_cnode_project_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","_Applications_MAMP_htdocs_project_react_cnode_project_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__","_Applications_MAMP_htdocs_project_react_cnode_project_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__","userInfo","info","fetchData","params","mdrender","react__WEBPACK_IMPORTED_MODULE_8___default","NewsContent","assign","afresh","_component_common_SharedCompt__WEBPACK_IMPORTED_MODULE_10__","_this3","_this4","console","log","actions","_ref","has_read_messages","length","hasnot_read_messages","hasMsgLen","hasNotMsgLen","defaultActiveKey","tab","map","item","index","NewsList","author","avatar_url","data-layout-flex","data-ellipsis","formatDate","create_at","react_router_dom__WEBPACK_IMPORTED_MODULE_9__","topic","id","title","dangerouslySetInnerHTML","__html","reply","content","_Applications_MAMP_htdocs_project_react_cnode_project_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","ActionNews","connect","ReadNews","dispatch","bindActionCreators"],"mappings":"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","file":"static/js/9.643939f5.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.3bd6cd42.png\";","import React from 'react'\nimport { Link } from 'react-router-dom'\n// import PropTypes from \"prop-types\";\n\nimport { setStorage } from '@script/utils'\n\nexport class UserLogin extends React.Component {\n  // static contextTypes = {   router: PropTypes.object }\n  constructor(props) {\n    super(props)\n    this.state = {\n      btnval: '登录'\n    }\n    this.loginSubmit = this.loginSubmit.bind(this)\n  }\n  enterSumit(e) {\n    Object.is(e.keyCode, 13) && this.loginSubmit()\n  }\n  loginSubmit() {\n    const UserTokenVal = this.refs.userToken.value\n    if (!UserTokenVal) {\n      return this.$showMsg('亲,token不能为空!')\n    }\n    this.setState({ btnval: '登录中...' })\n    this.$request({\n      method: 'post',\n      url: `accesstoken`,\n      data: {\n        accesstoken: UserTokenVal\n      },\n      success: result => {\n        if (result.success) {\n          this.$showMsg('登录成功!')\n          result['accesstoken'] = UserTokenVal\n          setStorage('USER_INFO', result)\n          this.props.history.push({\n            pathname: '/user',\n            search: `?name=${result.loginname}`\n          })\n        } else {\n          this.$showMsg('登录失败!')\n          this.setState({ btnval: '登录' })\n        }\n      },\n      error: () => {\n        this.$showMsg('登录失败!')\n        this.setState({ btnval: '登录' })\n      }\n    })\n  }\n  render() {\n    return (\n      <div className=\"user-login-form\">\n        <div className=\"ipt-row\">\n          <input\n            ref=\"userToken\"\n            className=\"bd-radius bd-none pdl\"\n            type=\"text\"\n            name=\"user-token\"\n            onKeyDown={this.enterSumit.bind(this)}\n            placeholder=\"Access Token\"\n          />\n        </div>\n        <div className=\"ipt-row\">\n          <input\n            className=\"bd-radius bg-color ft-white bd-none\"\n            type=\"submit\"\n            value={this.state.btnval}\n            onClick={this.loginSubmit}\n            name=\"btn-submit\"\n          />\n        </div>\n      </div>\n    )\n  }\n}\n\nexport const NotLogin = props => {\n  return (\n    <div className=\"not-login-wrap tc\">\n      {props.isLogo && (\n        <img\n          className=\"not-login-photo\"\n          src={require('@images/logo.png')}\n          alt=\"\"\n        />\n      )}\n      <h2 data-layout-align=\"center center\" data-layout=\"layout\">\n        还未登录，现在就去<Link className=\"ft-color\" to=\"/user/login\">\n          登录\n        </Link>\n      </h2>\n    </div>\n  )\n}\n\nNotLogin.defaultProps = {\n  isLogo: true\n}\n\nexport const DetectLogin = props => {\n  class LoginStatus extends React.Component {\n    // constructor(props) {\n    //   super(props)\n    // }\n    render() {\n      if (this.$getStorage()) return <props.realuser {...this.props} />\n      return <NotLogin />\n    }\n  }\n  return LoginStatus\n}\n\nexport const LoadLoop = () => <div className=\"tc pdtb\">玩命加载中...</div>\nexport const LoadFail = () => <div className=\"tc pdtb\">加载失败!</div>\nexport const NotResult = props => <div className=\"tc pdtb\">{props.text}</div>\n\nNotResult.defaultProps = {\n  text: '暂无数据!'\n}\n","import React from 'react'\nimport { Link } from 'react-router-dom'\nimport { DetectLogin, LoadLoop, NotResult } from '@component/common/SharedCompt'\nimport { Tabs } from 'antd'\nimport { formatDate } from '@script/utils'\nimport { bindActionCreators } from 'redux'\nimport { connect } from 'react-redux'\n\nimport ActionNews from '@store/actions/ActionNews'\n\nconst TabPane = Tabs.TabPane\n\nclass UserNews extends React.Component {\n  constructor(props) {\n    super(props)\n    this.userInfo = this.$getStorage()\n    this.state = {\n      info: {}\n    }\n  }\n  componentDidMount() {\n    this.fetchData()\n  }\n  fetchData() {\n    this.$request({\n      url: `messages`,\n      params: {\n        mdrender: false,\n        accesstoken: this.userInfo.accesstoken\n      },\n      success: result => {\n        this.setState({ info: result })\n      }\n    })\n  }\n  render() {\n    const { info } = this.state\n    return (\n      <div>\n        {info.data ? (\n          <NewsContent\n            {...this.props}\n            data={info.data}\n            afresh={this.fetchData.bind(this)}\n          />\n        ) : (\n          <LoadLoop />\n        )}\n      </div>\n    )\n  }\n}\n\nclass NewsContent extends React.Component {\n  constructor(props) {\n    super(props)\n    this.userInfo = this.$getStorage()\n  }\n  clearReadMsg() {\n    this.$request({\n      method: 'post',\n      url: `message/mark_all`,\n      data: {\n        accesstoken: this.userInfo.accesstoken\n      },\n      success: result => {\n        console.log(result)\n        this.props.afresh()\n        this.props.actions.fetchData()\n        this.userInfo && this.props.actions.fetchData(this.userInfo.accesstoken)\n      }\n    })\n  }\n  render() {\n    const { data } = this.props\n    const [hasMsgLen, hasNotMsgLen] = [\n      data.has_read_messages.length,\n      data.hasnot_read_messages.length\n    ]\n    return (\n      <div className=\"news-content container-bottom\">\n        <Tabs defaultActiveKey=\"1\">\n          <TabPane tab={`未读消息(${hasNotMsgLen})`} key=\"1\">\n            {hasNotMsgLen ? (\n              data.hasnot_read_messages.map((item, index) => {\n                return <NewsList item={item} key={index} />\n              })\n            ) : (\n              <NotResult text=\"暂无消息!\" />\n            )}\n          </TabPane>\n          <TabPane tab={`已读消息(${hasMsgLen})`} key=\"2\">\n            {hasMsgLen ? (\n              data.has_read_messages.map((item, index) => {\n                return <NewsList item={item} key={index} />\n              })\n            ) : (\n              <NotResult text=\"暂无消息!\" />\n            )}\n            {/* <div className=\"tc mgt\">\n              <button\n                onClick={this\n                .clearReadMsg\n                .bind(this)}\n                className=\"clear-unread-msg ft-white bg-color bd-radius\">清空未读消息</button>\n            </div> */}\n          </TabPane>\n        </Tabs>\n      </div>\n    )\n  }\n}\nconst NewsList = props => {\n  const { item } = props\n  const createMarkup = () => {\n    return { __html: item.reply.content }\n  }\n  return (\n    <div className=\"article-item mgt\">\n      <div data-layout=\"layout\" data-layout-align=\"start start\">\n        <img\n          className=\"author-avatar mgr bd-radius\"\n          src={item.author.avatar_url}\n          data-layout-flex=\"0\"\n          alt=\"\"\n        />\n        <div className=\"w100\">\n          <h3\n            data-ellipsis\n            data-layout=\"layout\"\n            data-layout-align=\"space-between center\"\n          >\n            <span className=\"title-cnt\" data-ellipsis>\n              {item.author.loginname}\n            </span>\n            {formatDate(item.create_at)}\n          </h3>\n          <div className=\"mgt\">\n            <div>\n              在话题<Link\n                className=\"ft-color\"\n                to={{\n                  pathname: `/index/article-details`,\n                  search: `?id=${item.topic.id}`,\n                  state: {\n                    id: item.topic.id\n                  }\n                }}\n              >\n                {item.topic.title}\n              </Link>\n              {item.type === 'at' ? '中@了你!' : '回复了你!'}\n              <div\n                className=\"mgt markdown-body\"\n                dangerouslySetInnerHTML={createMarkup()}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// export default DetectLogin({realuser: UserNews})\nconst mapStateToProps = state => {\n  return { ReadNews: state.ReadNews }\n}\nconst actions = {\n  ...ActionNews\n}\nconst mapDispatchToProps = dispatch => ({\n  actions: bindActionCreators(actions, dispatch)\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(\n  DetectLogin({ realuser: UserNews })\n)\n"],"sourceRoot":""}